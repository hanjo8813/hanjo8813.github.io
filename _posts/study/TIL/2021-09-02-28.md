---
title:  "[데브코스] Spring Rest API 2"
date: 2021-09-02
categories: 
  - TIL

# 고정값
classes: wide
toc: false
toc_sticky: false
---

W5D4 - 


## 렌더링 방식

![image](https://user-images.githubusercontent.com/71180414/131875349-80306e1f-fbbd-4532-9941-3c122534fdd3.png){:style="width:90%; margin-top:15px;"}

### MPA (Multiple Page Application)

- 여러개의 페이지로 구성된 APP. 전통적인 방식
- `SSR`(Server Side Rendering) 방식으로 렌더링
- 사용자 데이터는 서버에서 세션으로 처리
- 하나의 URL에 하나의 페이지를 매핑

### SPA (Single Page Application)

- 한 개의 페이지로 구성된 APP
- `CSR`(Client Side Rendering) 방식으로 렌더링함
- 사용자 데이터는 브라우저의 `local storage`를 함께 활용해 세션 의존도를 줄임
- 히스토리 API + DOM 조작을 통해 새로고침 없이 렌더링

### Proxy

- if) React에서 프론트를 서빙하는 웹서버가 있다 (3000번 포트로)
- 만약 프론트 부분에 백엔드로 요청을 보내는 코드를 작성하게 되면 CORS 에러 발생
- 프론트 코드에서 해당 주소를 웹서버로 넘기고 웹서버가 백엔드 서버로 요청해야함 (프록시 적용)

<br>

## ResponseEntity

- HTTP의 헤더나 상태코드를 처리하기 위한 자료형
- 응답 컨트롤러의 리턴값으로 주고 다양한 메소드를 통해 HTTP 타입을 표현 가능

```java
@GetMapping(".../{데이터}")
@ResponseBody
public ResponseEntity<제네릭> 메소드(@PathVariable(데이터) ...) {
  ResponseEntity.ok(...);
  ResponseEntity.status(...).body(...);
  ResponseEntity.notFound().build();
}
```

<br>

## CORS (Cross Origin Resource Sharing)

- 동일한 출처의 리소스에만 접근이 가능하도록 하는 규칙
- `프로토콜`, `호스트`, `포트`가 동일하면 Same Origin으로 본다.
- [이 블로그](https://beomy.github.io/tech/browser/cors/){:target="_blank"}에 매우 자세한 설명이 나와있음

### 단순요청

![image](https://user-images.githubusercontent.com/71180414/131894207-18a22b10-0ed5-4e8a-8254-3e9c7a310a4a.png){:style="width:60%; margin-top:15px;"}

- `GET`, `HEAD`, `POST` 메소드 요청
- 유저 에이전트가 자동으로 설정한 헤더
  - `Accept`
  - `Accept-Language`
  - `Content-Language`
  - `Content-Type`
- Content-Type 헤더는 아래 값들만 허용
  - `application/x-www-form-urlencoded`
  - `multipart/form-data`
  - `text/plain`

### 예비요청 (Preflight)

![image](https://user-images.githubusercontent.com/71180414/131888677-4b4b38a8-b3c5-411c-bfbe-e479ad36c17c.png){:style="width:60%; margin-top:15px;"}

- 단순 요청이 아닌경우엔 예비요청을 먼저 보낸다
- 서버가 예비요청을 받고 `Access-Control-Allow-Origin` 헤더를 포함한 응답을 브라우저로 보내줘야 비로소 본 요청이 이루어짐.
- 서버가 요청에 승인을 해주는 것이므로 서버측에서 CORS 모듈을 사용한다

<br>

## Spring CORS

- 

cors 설정 / 컨트롤러 어노테


요청 데이터의 타입이 맞지 않을때 도메인은 건들지말고 DTO를 만들어주자

어케만드냐? -> of to

요청의 validation 룰은 컨트롤러 / 비즈니스 도메인은 entity

