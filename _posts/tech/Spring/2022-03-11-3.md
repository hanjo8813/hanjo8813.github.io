---
title:  "Spring의 동작원리 2"
date: 2022-03-11
categories: 
  - Spring

# 고정값
classes: wide
toc: false
toc_sticky: false
---

Spring에서의 MVC 패턴과 DispatcherServlet을 알아보자


## MVC 패턴

지금까지 잘 알고 있는줄 알았던 MVC 패턴을 스프링에서 어떻게 사용하는지 알아보고자 한다.   

### 정의

- Model, View, Controller 세가지 구성요소로 이루어진 디자인 패턴이다.
    - Model : 표현하고자 하는 데이터
    - View : HTML과 같은 UI 요소
    - Controller : Model과 View를 연결하는 인터페이스 역할

### 초기의 서블릿 모습

```java
public 서블릿 extends HttpServlet {
    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        printWriter out = response.getWriter();
        out.println(docType + 
            "<HTML>\n" +
            "<HEAD><TITLE>" + title + "</TITLE></HEAD>\n" +
            ...
            "</BODY></HTML>");
        )
    }
}
```

위 예시 코드를 보면 하나의 서블릿이 요청을 받고, 서비스로직을 처리 후 html에 데이터를 바인딩하는 것을 볼 수 있다.   
즉 모델, 뷰, 컨트롤러의 책임을 하나의 서블릿이 모두 맡아 처리하는 것이다.   
누가봐도 코드가 더럽고 유지보수가 힘들어 보인다. 그래서 JSP가 등장한다.   

## JSP

JSP? 그거 완전 오래된 기술 아니야? 라고 생각했었는데, 여기에 스프링의 역사가 담겨있었다.   

우선 JSP의 초기 모델인 `MVC1` 부터 살펴보자

<div class="sub_title">MVC1</div>

```jsp
<%
String str = "test";
%>

<html>
<head>
<meta charset="UTF-8">
<title></title>
</head>
<body>
	<span><%= str %></span>
</body>
</html>
```

java 코드와 html 문법이 혼재되어 있는 형태이다.   
보통 java 코드 블록에서 java bean으로 등록된 model을 불러와 사용할 수 있다.   

즉, jsp의 파일하나가 컨트롤러와 뷰의 책임을 맡는 것이다.

![image](https://user-images.githubusercontent.com/71180414/157804029-d2540e45-efd7-4feb-9295-4dc7ce3a40c2.png)

이와 같이 말도 안되는 복잡도로 여기에 서블릿을 추가한 `MVC2`가 등장한다.

<div class="sub_title">MVC2</div>

```java
// web.xml이나 @WebServlet로 매핑되는 서블릿. 컨트롤러의 역할을 함
public 서블릿 extends HttpServlet {
    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // 모델 사용
    }
}
```

